/**
 * Amplifier Widget Setup
 *
 * @module    mod_amplifier/amplifier-setup
 * @copyright 2020 Know-Center GmbH
 * @license   http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
 */
define("mod_amplifier/amplifier-setup",["jquery","mod_amplifier/controller"],(function($,Controller){var courseId,courseModuleId,instanceId,userId,currentFieldset,nextFieldset,previousFieldset,participantCode="TODO insert participant code here",reflections=[],learningGoals=[],handleNextButtonClick=function(){if(currentFieldset=$(this).parent().parent(),nextFieldset=$(this).parent().parent().next(),$(this).hasClass("participantcode")&&(participantCode=$(this).parent().parent().find(".participantcode-input").val()),$(this).hasClass("reflective-question")){var userResponse=$(this).parent().parent().find(".amplifier-user-response-input").val(),topicId=$(this).parent().parent().find(".amplifier-user-response-input").attr("data-topicid"),goalId=$(this).parent().parent().find(".amplifier-user-response-input").attr("data-goalid");reflections.push({userResponse:userResponse,topicid:topicId,goalid:goalId})}$(this).hasClass("learning-goals")&&$(".predefined-learning-goal-check").each((function(idx,element){if($(element).is(":checked")){var _topicId=$(element).attr("data-topicid"),_goalId=$(element).attr("data-goalid");learningGoals.push({topicid:_topicId,goalid:_goalId})}})),currentFieldset.addClass("d-none"),nextFieldset.removeClass("d-none"),nextFieldset.show(),currentFieldset.hide()},handlePreviousButtonClick=function(){currentFieldset=$(this).parent().parent(),previousFieldset=$(this).parent().parent().prev(),currentFieldset.addClass("d-none"),previousFieldset.removeClass("d-none"),previousFieldset.show(),currentFieldset.hide()},handleSubmitButtonClick=function(){Controller.submitSetup({courseid:courseId,userid:userId,coursemoduleid:courseModuleId,instanceid:instanceId,participantcode:participantCode,reflections:JSON.stringify(reflections),learninggoals:JSON.stringify(learningGoals)}).then((function(){location.reload()})).catch((function(error){throw new Error(error)}))},handleLearningGoalClick=function(){var checkedCount=0;$(".predefined-learning-goal-check").each((function(idx,element){$(element).is(":checked")&&checkedCount++})),checkedCount>0&&checkedCount<=5?($(this).closest("fieldset").find("button.next.action-button").prop("disabled",!1),$(this).closest("fieldset").find("button.next.action-button").css("opacity","1")):($(this).closest("fieldset").find("button.next.action-button").prop("disabled",!0),$(this).closest("fieldset").find("button.next.action-button").css("opacity",".5"))},handleParticipantCodeChange=function(){5==$(this).val().length?($(this).closest("fieldset").find("button.next.action-button").prop("disabled",!1),$(this).closest("fieldset").find("button.next.action-button").css("opacity","1")):($(this).closest("fieldset").find("button.next.action-button").prop("disabled",!0),$(this).closest("fieldset").find("button.next.action-button").css("opacity",".5"))};return{init:function(paramCourseId,paramCourseModuleId,paramInstanceId,paramUserId){courseModuleId=paramCourseModuleId,instanceId=paramInstanceId,userId=paramUserId;var $amplifierSetupRoot=$("#amplifier-widget-".concat(courseId=paramCourseId,"-").concat(courseModuleId,"-").concat(instanceId));$amplifierSetupRoot.find(".amplifier-setup .next").click(handleNextButtonClick),$amplifierSetupRoot.find(".amplifier-setup .previous").click(handlePreviousButtonClick),$amplifierSetupRoot.find(".amplifier-setup .amplifier-submit-setup").click(handleSubmitButtonClick),$amplifierSetupRoot.find(".amplifier-setup .predefined-learning-goal-check").click(handleLearningGoalClick),$amplifierSetupRoot.find(".amplifier-setup .participantcode-input").change(handleParticipantCodeChange)}}}));

//# sourceMappingURL=amplifier-setup.min.js.map