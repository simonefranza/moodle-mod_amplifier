/**
 * Amplifier Widget
 *
 * @module    mod_amplifier/amplifier-widget
 * @copyright University of Technology Graz
 * @license   http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
 */
define("mod_amplifier/amplifier-widget",["jquery","mod_amplifier/controller"],(function($,Controller){var amplifier,userid,courseid,coursemoduleid,instanceid,participantcode,currentFieldset,nextFieldset,handleNextButtonClick=function(){currentFieldset=$(this).parent().parent(),nextFieldset=$(this).parent().parent().next(),currentFieldset.addClass("d-none"),nextFieldset.removeClass("d-none")},handleReminderSubmitButtonClick=function(){(currentFieldset=$(this).parent().parent()).parent().addClass("d-none");var amplifiergoalid=$(this).attr("data-goalid"),radioButton=$("#amplifier-user-goal-".concat(amplifiergoalid)).find("input[type=radio][name=reminder-frequency-options]:checked"),reminderFrequency=0;void 0!==radioButton.val()&&("daily"===radioButton.val()?reminderFrequency=0:"weekly"===radioButton.val()?reminderFrequency=1:"monthly"===radioButton.val()&&(reminderFrequency=2));var startDateDay=$("#amplifier-user-goal-".concat(amplifiergoalid)).find(".user-goal-reminder select.startdate-day option:selected").val(),startDateMonth=$("#amplifier-user-goal-".concat(amplifiergoalid)).find(".user-goal-reminder select.startdate-month option:selected").val(),startDateYear=$("#amplifier-user-goal-".concat(amplifiergoalid)).find(".user-goal-reminder select.startdate-year option:selected").val(),startDateHour=$("#amplifier-user-goal-".concat(amplifiergoalid)).find(".user-goal-reminder select.startdate-hour option:selected").val(),startDateMinute=$("#amplifier-user-goal-".concat(amplifiergoalid)).find(".user-goal-reminder select.startdate-minute option:selected").val(),endDateDay=$("#amplifier-user-goal-".concat(amplifiergoalid)).find(".user-goal-reminder select.enddate-day option:selected").val(),endDateMonth=$("#amplifier-user-goal-".concat(amplifiergoalid)).find(".user-goal-reminder select.enddate-month option:selected").val(),endDateYear=$("#amplifier-user-goal-".concat(amplifiergoalid)).find(".user-goal-reminder select.enddate-year option:selected").val(),endDateHour=$("#amplifier-user-goal-".concat(amplifiergoalid)).find(".user-goal-reminder select.enddate-hour option:selected").val(),endDateMinute=$("#amplifier-user-goal-".concat(amplifiergoalid)).find(".user-goal-reminder select.enddate-minute option:selected").val(),reminderHour=$("#amplifier-user-goal-".concat(amplifiergoalid)).find(".user-goal-reminder select.reminder-hour option:selected").val(),reminderMinute=$("#amplifier-user-goal-".concat(amplifiergoalid)).find(".user-goal-reminder select.reminder-minute option:selected").val(),startdate=Date.parse("".concat(startDateYear,"-").concat(startDateMonth,"-").concat(startDateDay,"T").concat(startDateHour,":").concat(startDateMinute,":00")),enddate=Date.parse("".concat(endDateYear,"-").concat(endDateMonth,"-").concat(endDateDay,"T").concat(endDateHour,":").concat(endDateMinute,":00"));Controller.saveReminder({startdate:startdate,enddate:enddate,reminderhour:parseInt(reminderHour),reminderminute:parseInt(reminderMinute),frequency:reminderFrequency,lastnotificationdate:0,goal:amplifiergoalid,user:userid,course:courseid,coursemodule:coursemoduleid,instance:instanceid,participantcode:participantcode})},handleReflectionSubmitButtonClick=function(){(currentFieldset=$(this).parent().parent()).addClass("d-none"),currentFieldset.parent().parent().addClass("d-none");var amplifiergoalid=$(this).attr("data-goalid"),reflections=[];$("#amplifier-user-goal-".concat(amplifiergoalid)).find(".amplifier-user-response-input").each((function(idx,element){reflections.push($(element).val())})),Controller.submitReflections({reflectiondate:Date.now(),reflections:JSON.stringify(reflections),goal:amplifiergoalid,user:userid,course:courseid,coursemodule:coursemoduleid,instance:instanceid,participantcode:participantcode})};return{init:function(userId,courseId,courseModuleId,instanceId,participantCode){var amplifierRoot=$("#amplifier-widget-".concat(courseId,"-").concat(courseModuleId,"-").concat(instanceId));userid=userId,courseid=courseId,coursemoduleid=courseModuleId,instanceid=instanceId,participantcode=participantCode,$(amplifier=amplifierRoot).find(".topic-card .user-goal-reminder").each((function(){if($(this)[0].hasAttribute("data-reminderfrequency")){var frequency=$(this).attr("data-reminderfrequency");0==frequency?($(this).find("input[type=radio][name=reminder-frequency-options][id=option_daily]").attr("checked","checked"),$(this).find("input[type=radio][name=reminder-frequency-options][id=option_daily]").parent().addClass("active"),$(this).find("input[type=radio][name=reminder-frequency-options][id=option_weekly]").parent().removeClass("active"),$(this).find("input[type=radio][name=reminder-frequency-options][id=option_monthly]").parent().removeClass("active")):1==frequency?($(this).find("input[type=radio][name=reminder-frequency-options][id=option_weekly]").attr("checked","checked"),$(this).find("input[type=radio][name=reminder-frequency-options][id=option_daily]").parent().removeClass("active"),$(this).find("input[type=radio][name=reminder-frequency-options][id=option_weekly]").parent().addClass("active"),$(this).find("input[type=radio][name=reminder-frequency-options][id=option_monthly]").parent().removeClass("active")):2==frequency&&($(this).find("input[type=radio][name=reminder-frequency-options][id=option_monthly]").attr("checked","checked"),$(this).find("input[type=radio][name=reminder-frequency-options][id=option_daily]").parent().removeClass("active"),$(this).find("input[type=radio][name=reminder-frequency-options][id=option_weekly]").parent().removeClass("active"),$(this).find("input[type=radio][name=reminder-frequency-options][id=option_monthly]").parent().addClass("active"))}else $(this).find("input[type=radio][name=reminder-frequency-options][id=option_daily]").attr("checked","checked"),$(this).find("input[type=radio][name=reminder-frequency-options][id=option_daily]").parent().addClass("active"),$(this).find("input[type=radio][name=reminder-frequency-options][id=option_weekly]").parent().removeClass("active"),$(this).find("input[type=radio][name=reminder-frequency-options][id=option_monthly]").parent().removeClass("active");if($(this)[0].hasAttribute("data-startdate-day")){var startDateDay=$(this).attr("data-startdate-day"),startDateMonth=$(this).attr("data-startdate-month"),startDateYear=$(this).attr("data-startdate-year"),startDateHour=$(this).attr("data-startdate-hour"),startDateMinute=$(this).attr("data-startdate-minute"),endDateDay=$(this).attr("data-enddate-day"),endDateMonth=$(this).attr("data-enddate-month"),endDateYear=$(this).attr("data-enddate-year"),endDateHour=$(this).attr("data-enddate-hour"),endDateMinute=$(this).attr("data-enddate-minute"),reminderHour=$(this).attr("data-reminder-hour").toString().padStart(2,"0"),reminderMinute=$(this).attr("data-reminder-minute").toString().padStart(2,"0");$(this).find("select.startdate-day option[value=".concat(startDateDay,"]")).attr("selected","selected"),$(this).find("select.startdate-month option[value=".concat(startDateMonth,"]")).attr("selected","selected"),$(this).find("select.startdate-year option[value=".concat(startDateYear,"]")).attr("selected","selected"),$(this).find("select.startdate-hour option[value=".concat(startDateHour,"]")).attr("selected","selected"),$(this).find("select.startdate-minute option[value=".concat(startDateMinute,"]")).attr("selected","selected"),$(this).find("select.enddate-day option[value=".concat(endDateDay,"]")).attr("selected","selected"),$(this).find("select.enddate-month option[value=".concat(endDateMonth,"]")).attr("selected","selected"),$(this).find("select.enddate-year option[value=".concat(endDateYear,"]")).attr("selected","selected"),$(this).find("select.enddate-hour option[value=".concat(endDateHour,"]")).attr("selected","selected"),$(this).find("select.enddate-minute option[value=".concat(endDateMinute,"]")).attr("selected","selected"),$(this).find("select.reminder-hour option[value=".concat(reminderHour,"]")).attr("selected","selected"),$(this).find("select.reminder-minute option[value=".concat(reminderMinute,"]")).attr("selected","selected")}else{var currentdate=new Date;$(this).find("select.startdate-day option[value=".concat(currentdate.getDate(),"]")).attr("selected","selected"),$(this).find("select.startdate-month option[value=".concat(currentdate.getMonth()+1,"]")).attr("selected","selected"),$(this).find("select.startdate-year option[value=".concat(currentdate.getFullYear(),"]")).attr("selected","selected"),$(this).find("select.startdate-hour option[value=".concat(currentdate.getHours(),"]")).attr("selected","selected"),$(this).find("select.startdate-minute option[value=".concat(0,"]")).attr("selected","selected"),$(this).find("select.enddate-day option[value=".concat(currentdate.getDate()+7,"]")).attr("selected","selected"),$(this).find("select.enddate-month option[value=".concat(currentdate.getMonth()+1,"]")).attr("selected","selected"),$(this).find("select.enddate-year option[value=".concat(currentdate.getFullYear(),"]")).attr("selected","selected"),$(this).find("select.enddate-hour option[value=".concat(currentdate.getHours(),"]")).attr("selected","selected"),$(this).find("select.enddate-minute option[value=".concat(0,"]")).attr("selected","selected"),$(this).find("select.reminder-hour option[value=".concat(currentdate.getHours(),"]")).attr("selected","selected"),$(this).find("select.reminder-minute option[value=".concat(0,"]")).attr("selected","selected")}})),$(amplifier).find(".next.action-button.reflective-question").click(handleNextButtonClick),$(amplifier).find(".submit.action-button.reflection-submit").click(handleReflectionSubmitButtonClick),$(amplifier).find(".reminder-dropdown-toggle").on("click",(function(){$("#".concat($(this).attr("data-target"))).toggleClass("d-none")})),$(amplifier).find(".reflection-dropdown-toggle").on("click",(function(){$("#".concat($(this).attr("data-target"))).toggleClass("d-none"),$("#".concat($(this).attr("data-target")," .user-goal-reflection fieldset")).first().toggleClass("d-none")})),$(amplifier).find(".user-goal-reminder-save").on("click",handleReminderSubmitButtonClick)}}}));

//# sourceMappingURL=amplifier-widget.min.js.map